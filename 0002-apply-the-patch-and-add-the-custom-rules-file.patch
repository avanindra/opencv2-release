From 7bea86a56aec7357bc336279e31b39b50d8e2722 Mon Sep 17 00:00:00 2001
From: Vincent Rabaud <vrabaud@willowgarage.com>
Date: Wed, 3 Oct 2012 08:47:14 -0700
Subject: [PATCH 2/7] apply the patch and add the custom rules file

---
 cmake/templates/opencv-XXX.pc.cmake.in |    3 ++-
 rules                                  |   37 ++++++++++++++++++++++++++++++++
 2 files changed, 39 insertions(+), 1 deletion(-)
 create mode 100644 rules

diff --git a/cmake/templates/opencv-XXX.pc.cmake.in b/cmake/templates/opencv-XXX.pc.cmake.in
index 4f6415c..af0dad3 100644
--- a/cmake/templates/opencv-XXX.pc.cmake.in
+++ b/cmake/templates/opencv-XXX.pc.cmake.in
@@ -9,5 +9,6 @@ includedir_new=@includedir@
 Name: OpenCV
 Description: Open Source Computer Vision Library
 Version: @VERSION@
-Libs: @OpenCV_LIB_COMPONENTS@
+Libs: -L${exec_prefix}/lib -lopencv_calib3d -lopencv_contrib -lopencv_core -lopencv_features2d -lopencv_flann -lopencv_gpu -lopencv_highgui -lopencv_imgproc -lopencv_legacy -lopencv_ml -lopencv_nonfree -lopencv_objdetect -lopencv_photo -lopencv_stitching -lopencv_ts -lopencv_video -lopencv_videostab
 Cflags: -I${includedir_old} -I${includedir_new}
+
diff --git a/rules b/rules
new file mode 100644
index 0000000..ff50b72
--- /dev/null
+++ b/rules
@@ -0,0 +1,37 @@
+#!/usr/bin/make -f
+# -*- makefile -*-
+# Sample debian/rules that uses debhelper.
+# This file was originally written by Joey Hess and Craig Small.
+# As a special exception, when this file is copied by dh-make into a
+# dh-make output file, you may use that output file without restriction.
+# This special exception was added by Craig Small in version 0.37 of dh-make.
+
+# Uncomment this to turn on verbose mode.
+export DH_VERBOSE=1
+export DH_OPTIONS=-v
+export CMAKE_PREFIX_PATH="@(INSTALL_PREFIX)"
+CMAKE_FLAGS = \
+	-DCMAKE_BUILD_TYPE=Release \
+	-DENABLE_SSE=ON \
+	-DENABLE_SSE2=ON \
+	-DENABLE_SSE3=ON \
+	-DENABLE_SSE42=OFF \
+	-DENABLE_SSE41=OFF \
+	-DUSE_FAST_MATH=OFF \
+	-DBUILD_EXAMPLES=OFF \
+	-DBUILD_DOCS=ON \
+	-DBUILD_TESTS=OFF \
+	-DBUILD_NEW_PYTHON_SUPPORT=ON \
+	-DWITH_V4L=ON \
+	-DWITH_CUDA=OFF \
+
+%:
+	dh  $@@
+
+override_dh_auto_configure:
+	dh_auto_configure -Scmake -- \
+		-DCMAKE_INSTALL_PREFIX="@(INSTALL_PREFIX)" \
+		-DCMAKE_PREFIX_PATH="@(INSTALL_PREFIX)" \
+		-DCATKIN=YES \
+                -DCATKIN_BUILD_BINARY_PACKAGE="1" \
+		$(CMAKE_FLAGS)
-- 
1.7.9.5

